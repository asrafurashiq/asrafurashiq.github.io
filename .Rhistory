district
ggplot(bd)+geom_polygon()
ggplot(district)+geom_polygon(aes(lon,lat))
names(bd)
bd %>% ggplot()+geom_sf(aes(fill=NAME_2))+theme(legend.position = "")
bd <- read_sf("Bangladesh data/BGD_adm2.shp")
ggplot(bd)+geom_sf(aes(fill=NAME_2))+theme(legend.position = "")
ggplot(bd)+geom_sf(aes(fill=NAME_2))+theme(legend.position = "")+
geom_point(data=district,aes(x=lon,y=lat),size=2)
district$lon
district$District[51]
district$lon[51] <- 88.9749
district$lon
district$lon[51]
district$District[39]
district$lon[39] <- 89.4198
district$lon[39]
district$lon
district$District[12]
district$lon[12]
district$lon[12] <- 90.6631
district$lon[12]
which(district$lon==84.44041 )
district$lon[24]
district$District[24]
district$lon[24] <- 89.8224
district$lon[24]
district$lat
which(district$lat==45.26667)
district[39]
district$District[39]
district$lat[39] <- 23.4855
which(district$lat==45.26667)
which(district$lat==23.4855)
which(district$lat==29.13506)
district$lat[12] <- 23.2321
district$lat
which(district$lat==26.46734)
district$District[24]
district$lat[24] <- 23.0130
district$lat
district$lat[51]
district$District[51]
district$lat[51]
district$lat[51] <- 24.4079
district$lat[51]
ggplot(bd)+geom_sf(aes(fill=NAME_2))+theme(legend.position = "")+
geom_point(data=district,aes(x=lon,y=lat),size=2)
save(district,file="lat lon district.Rdata")
load("lat lon district.Rdata")
View(district)
ggplot(bd)+geom_sf(aes(fill=NAME_2))+theme(legend.position = "")+
geom_point(data=district,aes(x=lon,y=lat),size=2)
bd <- read_sf("Bangladesh data/BGD_adm2.shp")
ggplot(bd)+geom_sf(aes(fill=NAME_2))+theme(legend.position = "")+
geom_point(data=district,aes(x=lon,y=lat),size=2)
district
ggplot(bd)+geom_sf(aes(fill=NAME_2))+theme(legend.position = "")+
geom_point(data=district,aes(x=lon,y=lat),size=Cases/1000,col="red",alpha=.3)
ggplot(bd)+geom_sf(aes(fill=NAME_2))+theme(legend.position = "")+
geom_point(data=district,aes(x=lon,y=lat),size=~Cases/1000,col="red",alpha=.3)
ggplot(bd)+geom_sf(aes(fill=NAME_2))+theme(legend.position = "")+
geom_point(data=district,aes(x=lon,y=lat,size=Cases/1000),col="red",alpha=.3)
ggplot(bd)+geom_sf(aes(fill=NAME_2))+theme(legend.position = "")+
geom_point(data=district,aes(x=lon,y=lat,size=Cases/100),col="red",alpha=.5)
ggplot(bd)+geom_sf(aes(fill=NAME_2))+theme(legend.position = "")+
geom_point(data=district,aes(x=lon,y=lat,size=Cases),col="red",alpha=.5)
ggplot(bd)+geom_sf(aes(fill=NAME_2))+theme(legend.position = "")+
geom_point(data=district,aes(x=lon,y=lat,size=Cases),col="red",alpha=1)
ggplot(bd)+geom_sf(aes(fill=NAME_2))+theme(legend.position = "")+
geom_point(data=district,aes(x=lon,y=lat,size=Cases*2),col="red",alpha=1)
ggplot(bd)+geom_sf(aes(fill=NAME_2))+theme(legend.position = "")+
geom_point(data=district,aes(x=lon,y=lat,size=Cases*2),col="black",alpha=1)
ggplot(bd)+geom_sf(aes(fill=NAME_2))+theme(legend.position = "")+
geom_point(data=district,aes(x=lon,y=lat,size=(Cases*2)),col="black",alpha=1)
ggplot(bd)+geom_sf(aes())+theme(legend.position = "top")+
geom_point(data=district,aes(x=lon,y=lat,size=(Cases*2)),col="black",alpha=1)
ggplot(bd)+geom_sf(aes())+theme()+
geom_point(data=district,aes(x=lon,y=lat,size=(Cases*2)),col="black",alpha=1)
ggplot(bd)+geom_sf(aes())+
geom_point(data=district,aes(x=lon,y=lat,size=(Cases*2)),col="black",alpha=1)
ggplot(bd)+geom_sf(aes())+theme(legend.position = "right")
geom_point(data=district,aes(x=lon,y=lat,size=Cases),col="black",alpha=1)
ggplot(bd)+geom_sf(aes(fill=NAME_2))+theme(legend.position = "")
geom_point(data=district,aes(x=lon,y=lat,size=~Cases),col="black",alpha=1)
geom_point(data=district,aes(x=lon,y=lat,size=Cases*2),col="black",alpha=1)
geom_point(data=district,aes(x=lon,y=lat,size=Cases*2),na.rm = T,col="black",alpha=1)
ggplot(bd)+geom_sf(aes(fill=NAME_2))+theme(legend.position = "")+
geom_point(data=district,aes(x=lon,y=lat,size=(Cases*2)),col="black",alpha=1)
ggplot(bd)+geom_sf(aes(fill=NAME_2))+theme(legend.position = "")+
geom_point(data=district,aes(x=lon,y=lat,size=Cases),col="black",alpha=1)
ggplot(bd)+geom_sf(aes(fill=NAME_2))+theme(legend.position = "")+
geom_point(data=district,aes(x=lon,y=lat,size=Cases,col=Cases),col="black",alpha=1)
ggplot(bd)+geom_sf(aes(fill=NAME_2))+theme(legend.position = "")+
geom_point(data=district,aes(x=lon,y=lat,size=Cases,alpha=Cases),col="black",alpha=1)
ggplot(bd)+geom_sf(aes(fill=NAME_2))+theme(legend.position = "")+
geom_point(data=district,aes(x=lon,y=lat,size=Cases,alpha=Cases),col="black")
ggplot(bd)+geom_sf(aes(fill=NAME_2))+theme(legend.position = "")+
geom_point(data=district,aes(x=lon,y=lat,col=Cases,size=Cases,alpha=Cases),col="black")
ggplot(bd)+geom_sf(aes(fill=NAME_2))+theme(legend.position = "")+
geom_point(data=district,aes(x=lon,y=lat,col=Cases,size=Cases,alpha=Cases))
ggplot(bd)+geom_sf(aes(fill=NAME_2))+theme(legend.position = "")+
geom_point(data=district,aes(x=lon,y=lat,col=Cases,size=Cases,alpha=Cases),col="red")
ggplot(bd)+geom_sf(fill="grey60")+theme(legend.position = "")+
geom_point(data=district,aes(x=lon,y=lat,col=Cases,size=Cases,alpha=Cases),col="red")
bd %>% inner_join(district,by="NAME_2")
district %>% rename(NAME_2=District)%>% inner_join(bd,by="NAME_2")
bd <- district %>% rename(NAME_2=District)%>% inner_join(bd,by="NAME_2")
ggplot(bd)+geom_sf()+theme(legend.position = "")+
geom_point(aes(x=lon,y=lat,col=Cases,size=Cases,alpha=Cases),col="red")
bd$geometry
ggplot(bd)+geom_sf()+theme(legend.position = "")+
geom_point(aes(x=lon,y=lat,col=Cases,size=Cases,alpha=Cases),col="red")
bd
class(bd)
bd %>% select(geometry)
bd %>% select(geometry,names(bd)[-13])
bd %>% select(geometry,names(bd)[-13]) %>% ggplot()+geom_sf()
rlang::last_error()
ggplot(bd)+geom_sf()+theme(legend.position = "")+
geom_point(aes(x=lon,y=lat,col=Cases,size=Cases,alpha=Cases),col="red")
bd <- district %>% rename(NAME_2=District)%>% right_join(bd,by="NAME_2")
ggplot(bd)+geom_sf()+theme(legend.position = "")+
geom_point(aes(x=lon,y=lat,col=Cases,size=Cases,alpha=Cases),col="red")
bd
ggplot(bd)+geom_sf()+theme(legend.position = "")+
geom_point(aes(x=lon.x,y=lat.x,col=Cases.x),col="red")
district <- readxl::read_xlsx("Bangladesh data/COVID-19.xlsx")
#district <- district %>% mutate_geocode(District,source='dsk')
#save(district,file="lat lon district.Rdata")
load("lat lon district.Rdata")
ggplot(bd)+geom_sf()+theme(legend.position = "")+
geom_point(aes(x=lon.x,y=lat.x,col=Cases.x),col="red")
ggplot(bd)+geom_sf()+theme(legend.position = "")+
geom_point(data=district,aes(x=lon,y=lat,col=Cases.x),col="red")
ggplot(bd)+geom_sf()+theme(legend.position = "")+
geom_point(data=district,aes(x=lon,y=lat,col=Cases),col="red")
bd <- read_sf("Bangladesh data/BGD_adm2.shp")
#district <- district %>% mutate_geocode(District,source='dsk')
#save(district,file="lat lon district.Rdata")
load("lat lon district.Rdata")
ggplot(bd)+geom_sf()+theme(legend.position = "")+
geom_point(data=district,aes(x=lon,y=lat,col=Cases),col="red")
ggplot(bd)+geom_sf()+theme(legend.position = "")+
geom_point(data=district,aes(x=lon,y=lat,size=Cases),col="red")
library(plotly)
m <-  ggplot(bd)+geom_sf()+theme(legend.position = "")+
geom_point(data=district,aes(x=lon,y=lat,size=Cases),col="red")
ggplotly(m)
m <-  ggplot(bd)+geom_sf()+theme(legend.position = "")+
geom_point(data=district,aes(x=lon,y=lat,size=Cases,text=NAME_2),col="red")
ggplotly(m)
m <-  ggplot(bd)+geom_sf()+theme(legend.position = "")+
geom_point(data=district,aes(x=lon,y=lat,size=Cases,text=District),col="red")
ggplotly(m)
m <-  ggplot(bd)+geom_sf(aes(fill=NAME_2))+theme(legend.position = "")+
geom_point(data=district,aes(x=lon,y=lat,size=Cases,text=District),col="red")+
ggrepel::geom_text_repel(data=district,aes(label=Cases))
m
m <-  ggplot(bd)+geom_sf(aes(fill=NAME_2))+theme(legend.position = "")+
geom_point(data=district,aes(x=lon,y=lat,size=Cases,text=District),col="red")+
ggrepel::geom_text_repel(data=district,aes(x=lon,y=lat,label=Cases))
m
district <- district  %>% mutate(lab=ifelse(Cases>2000,Cases,NA))
m <-  ggplot(bd)+geom_sf(aes(fill=NAME_2))+theme(legend.position = "")+
geom_point(data=district,aes(x=lon,y=lat,size=Cases,text=District),col="red")+
ggrepel::geom_text_repel(data=district,aes(x=lon,y=lat,label=Cases))
m
m <-  ggplot(bd)+geom_sf(aes(fill=NAME_2))+theme(legend.position = "")+
geom_point(data=district,aes(x=lon,y=lat,size=Cases,text=District),col="red")+
ggrepel::geom_text_repel(data=district,aes(x=lon,y=lat,label=as.character(lab)))
m
m <-  ggplot(bd)+geom_sf(aes(fill=NAME_2))+theme(legend.position = "")+
geom_point(data=district,aes(x=lon,y=lat,size=Cases,text=District),col="red")+
ggrepel::geom_label_repel(data=district,aes(x=lon,y=lat,label=as.character(lab),alpha=.5))
m
m <-  ggplot(bd)+geom_sf(aes(fill=NAME_2))+theme(legend.position = "")+
geom_point(data=district,aes(x=lon,y=lat,size=Cases,text=District),col="red")+
ggrepel::geom_label_repel(data=district,aes(x=lon,y=lat,label=as.character(lab),alpha=.5))+scale_fill_brewer(palette = "Set1")+theme_minimal()
m
m <-  ggplot(bd)+geom_sf(aes(fill=NAME_2))+
geom_point(data=district,aes(x=lon,y=lat,size=Cases,text=District),col="red")+
ggrepel::geom_label_repel(data=district,aes(x=lon,y=lat,label=as.character(lab),alpha=.5))+scale_fill_brewer(palette = "Set1")+theme_minimal()+theme(legend.position = "")
m
district <- district  %>% mutate(lab=ifelse(Cases>2500,paste(District,Cases,NA)))
district <- district  %>% mutate(lab=ifelse(Cases>2500,paste(District,Cases),NA))
m <-  ggplot(bd)+geom_sf(aes(fill=NAME_2))+
geom_point(data=district,aes(x=lon,y=lat,size=Cases,text=District),col="red")+
ggrepel::geom_label_repel(data=district,aes(x=lon,y=lat,label=as.character(lab),alpha=.5))+theme_minimal()+theme(legend.position = "")
m
m
cat("asdfasfda","\n","afafsafsgsa")
paste("asdfasfda","\n","afafsafsgsa")
paste0("asdfasfda","\n","afafsafsgsa")
cat("asdfasfda","\n","afafsafsgsa")
library(tidyverse)
library(flexdashboard)
library(flexdashboard)
library(tidyverse)
library(flexdashboard)
library(tidyverse)
library(leaflet)
library(plotly)
#library(stringr)
load("datafinal.Rdata")
theme_set(ggthemes::theme_economist())
df <-  data %>% group_by(location,data_type)%>% summarise(total=sum(value)) %>% pivot_wider(names_from = data_type,values_from=total)%>%arrange(-cases_new)
p1 <- df %>%filter(location %in% df$location[1:9])%>% ggplot(aes(reorder(location,-cases_new),cases_new))+geom_bar(stat="identity",aes(fill=location))+labs(y="total",x="")+theme(legend.position = "")+scale_y_continuous(breaks = seq(0,4e+6,1000000))+geom_text(aes(label=cases_new),vjust=-1000)+scale_fill_brewer(palette = "Set1")+theme(axis.text.x = element_text(angle = 45))
ggplotly(p1)
p1 <- df %>%filter(location %in% df$location[1:9])%>% ggplot(aes(reorder(location,-cases_new),cases_new))+geom_bar(stat="identity",aes(fill=location))+labs(y="total",x="")+theme(legend.position = "")+scale_y_continuous(breaks = seq(0,4e+6,1000000))+geom_text(aes(label=cases_new),vjust=-10000)+scale_fill_brewer(palette = "Set1")+theme(axis.text.x = element_text(angle = 60))
p1 <- df %>%filter(location %in% df$location[1:9])%>% ggplot(aes(reorder(location,-cases_new),cases_new))+geom_bar(stat="identity",aes(fill=location))+labs(y="total",x="")+theme(legend.position = "")+scale_y_continuous(breaks = seq(0,4e+6,1000000))+geom_text(aes(label=cases_new),vjust=-10000)+scale_fill_brewer(palette = "Set1")+theme(axis.text.x = element_text(angle = 60))
ggplotly(p1)
p1 <- df %>%filter(location %in% df$location[1:9])%>% ggplot(aes(reorder(location,-cases_new),cases_new))+geom_bar(stat="identity",aes(fill=location))+labs(y="total",x="")+theme(legend.position = "")+scale_y_continuous(breaks = seq(0,4e+6,1000000))+geom_text(aes(label=cases_new),vjust=-100000)+scale_fill_brewer(palette = "Set1")+theme(axis.text.x = element_text(angle = 25))
ggplotly(p1)
data
options(max.print = 1000)
options(max.print = 100)
data
data %>% filter(location==df$location[1:9])%>% group_by(location,data_type)%>%
summarise(total=sum(value))
data %>% filter(location==df$location[1:9])
data %>% filter(location==df$location[1:9])%>% group_by(location,data_type)
data %>%  group_by(location,data_type)%>%
summarise(total=sum(value))
p1 <-  data %>%  group_by(location,data_type)%>%
summarise(total=sum(value))%>%filter(location==df$location[1:9])%>%
ggplot(aes(reorder(location,-cases_new),cases_new))+geom_bar(stat="identity",aes(fill=location))+labs(y="total",x="")+theme(legend.position = "")+scale_y_continuous(breaks = seq(0,4e+6,1000000))+geom_text(aes(label=cases_new),vjust=-100000)+scale_fill_brewer(palette = "Set1")+theme(axis.text.x = element_text(angle = 25))
p1 <-  data %>%  group_by(location,data_type)%>%
summarise(total=sum(value))%>%filter(location==df$location[1:9])%>%
ggplot(aes(reorder(location,-value),value))+geom_bar(stat="identity",aes(fill=location))+labs(y="total",x="")+theme(legend.position = "")+scale_y_continuous(breaks = seq(0,4e+6,1000000))+geom_text(aes(label=cases_new),vjust=-100000)+scale_fill_brewer(palette = "Set1")+theme(axis.text.x = element_text(angle = 25))
bd <- read_sf("Bangladesh data/BGD_adm2.shp")
district <- readxl::read_xlsx("Bangladesh data/COVID-19.xlsx")
#district <- district %>% mutate_geocode(District,source='dsk')
#save(district,file="lat lon district.Rdata")
load("lat lon district.Rdata")
district <- district  %>% mutate(lab=ifelse(Cases>2500,paste(District,Cases),NA))
m <-  ggplot(bd)+geom_sf(aes(fill=NAME_2))+
geom_point(data=district,aes(x=lon,y=lat,size=Cases,text=District),col="red")+
ggrepel::geom_label_repel(data=district,aes(x=lon,y=lat,label=as.character(lab),alpha=.5))+theme_minimal()+theme(legend.position = "")
m <-  ggplot(bd)+geom_sf(aes(fill=NAME_2))+
geom_point(data=district,aes(x=lon,y=lat,size=Cases,text=District),col="red")+
ggrepel::geom_label_repel(data=district,aes(x=lon,y=lat,label=as.character(lab),alpha=.5))+theme_minimal()+theme(legend.position = "")
m
district <- district  %>% mutate(lab=ifelse(Cases>2500,ifelse(lon>90,paste(District,Cases),NA),NA))
m <-  ggplot(bd)+geom_sf(aes(fill=NAME_2))+
geom_point(data=district,aes(x=lon,y=lat,size=Cases),col="red")+
ggrepel::geom_label_repel(data=district,aes(x=lon,y=lat,label=as.character(lab),alpha=.5))+theme_minimal()+theme(legend.position = "")
m
m <-  ggplot(bd)+geom_sf(aes(fill=NAME_2))+
geom_point(data=district,aes(x=lon,y=lat,size=Cases),col="red")+
ggrepel::geom_label_repel(data=district1,aes(x=lon,y=lat,label=as.character(lab),alpha=.5))+ggrepel::geom_label_repel(data=district2,aes(lon,lat,label=as.character(lab)),alpha=.5)
district1 <- district  %>% mutate(lab=ifelse(Cases>2500,ifelse(lon>90,paste(District,Cases),NA),NA))
district2 <- district  %>% mutate(lab=ifelse(Cases>2500,ifelse(lon<90,paste(District,Cases),NA),NA))
m <-  ggplot(bd)+geom_sf(aes(fill=NAME_2))+
geom_point(data=district,aes(x=lon,y=lat,size=Cases),col="red")+
ggrepel::geom_label_repel(data=district1,aes(x=lon,y=lat,label=as.character(lab),alpha=.5))+ggrepel::geom_label_repel(data=district2,aes(lon,lat,label=as.character(lab)),alpha=.5)
theme_minimal()+theme(legend.position = "")
m <-  ggplot(bd)+geom_sf(aes(fill=NAME_2))+
geom_point(data=district,aes(x=lon,y=lat,size=Cases),col="red")+
ggrepel::geom_label_repel(data=district1,aes(x=lon,y=lat,label=as.character(lab),alpha=.5))+ggrepel::geom_label_repel(data=district2,aes(lon,lat,label=as.character(lab)),alpha=.5)+
theme_minimal()+theme(legend.position = "")
m
m <-  ggplot(bd)+geom_sf(aes(fill=NAME_2))+
geom_point(data=district,aes(x=lon,y=lat,size=Cases),col="red")+
ggrepel::geom_label_repel(data=district1,aes(x=lon,y=lat,label=as.character(lab),alpha=.5))+ggrepel::geom_label_repel(data=district2,aes(lon,lat,label=as.character(lab)),alpha=.5,nudge_x = -2)+
theme_minimal()+theme(legend.position = "")
m
m <-  ggplot(bd)+geom_sf(aes(fill=NAME_2))+
geom_point(data=district,aes(x=lon,y=lat,size=Cases),col="red")+
ggrepel::geom_label_repel(data=district1,aes(x=lon,y=lat,label=as.character(lab),alpha=.5))+ggrepel::geom_label_repel(data=district2,aes(lon,lat,label=as.character(lab)),alpha=.5,nudge_x = -4)+
theme_minimal()+theme(legend.position = "")
m
m <-  ggplot(bd)+geom_sf(aes(fill=NAME_2))+
geom_point(data=district,aes(x=lon,y=lat,size=Cases),col="red")+
ggrepel::geom_label_repel(data=district1,aes(x=lon,y=lat,label=as.character(lab),alpha=.5))+ggrepel::geom_label_repel(data=district2,aes(lon,lat,label=as.character(lab)),alpha=.5,nudge_x = -10)+
theme_minimal()+theme(legend.position = "")
m
m <-  ggplot(bd)+geom_sf(aes(fill=NAME_2))+
geom_point(data=district,aes(x=lon,y=lat,size=Cases),col="red")+
ggrepel::geom_label_repel(data=district1,aes(x=lon,y=lat,label=as.character(lab),alpha=.5),nudge_x = 10)+
ggrepel::geom_label_repel(data=district2,aes(lon,lat,label=as.character(lab)),alpha=.5,nudge_x = -10)+
theme_minimal()+theme(legend.position = "")
m
district1 <- district  %>% mutate(lab=ifelse(Cases>2500,ifelse(lon>91,paste(District,Cases),NA),NA))
m <-  ggplot(bd)+geom_sf(aes(fill=NAME_2))+
geom_point(data=district,aes(x=lon,y=lat,size=Cases),col="red")+
ggrepel::geom_label_repel(data=district1,aes(x=lon,y=lat,label=as.character(lab),alpha=.5),nudge_x = 10)+
ggrepel::geom_label_repel(data=district2,aes(lon,lat,label=as.character(lab)),alpha=.5,nudge_x = -10)+
theme_minimal()+theme(legend.position = "")
m
district1 <- district  %>% mutate(lab=ifelse(Cases>2500,ifelse(lon>91,paste(District,Cases),NA),NA))
district2 <- district  %>% mutate(lab=ifelse(Cases>2500,ifelse(lon<=91,paste(District,Cases),NA),NA))
m <-  ggplot(bd)+geom_sf(aes(fill=NAME_2))+
geom_point(data=district,aes(x=lon,y=lat,size=Cases),col="red")+
ggrepel::geom_label_repel(data=district1,aes(x=lon,y=lat,label=as.character(lab),alpha=.5),nudge_x = 10)+
ggrepel::geom_label_repel(data=district2,aes(lon,lat,label=as.character(lab)),alpha=.5,nudge_x = -10)+
theme_minimal()+theme(legend.position = "")
m
m <-  ggplot(bd)+geom_sf(aes(fill=NAME_2))+
geom_point(data=district,aes(x=lon,y=lat,size=Cases),col="red")+
ggrepel::geom_label_repel(data=district1,aes(x=lon,y=lat,label=as.character(lab),alpha=.5),nudge_x = 10)+
ggrepel::geom_label_repel(data=district2,aes(lon,lat,label=as.character(lab)),alpha=.5,nudge_x = -15)+
theme_minimal()+theme(legend.position = "")
m
m <-  ggplot(bd)+geom_sf(aes(fill=NAME_2))+
geom_point(data=district,aes(x=lon,y=lat,size=Cases),col="red")+
ggrepel::geom_label_repel(data=district1,aes(x=lon,y=lat,label=as.character(lab),alpha=.5),nudge_x = 10)+
ggrepel::geom_label_repel(data=district2,aes(lon,lat,label=as.character(lab)),alpha=.5,nudge_x = -25)+
theme_minimal()+theme(legend.position = "")
m
district <- readxl::read_xlsx("Bangladesh data/COVID-19.xlsx")
#district <- district %>% mutate_geocode(District,source='dsk')
#save(district,file="lat lon district.Rdata")
load("lat lon district.Rdata")
district <- district  %>% mutate(lab=ifelse(Cases>2500,paste(District,Cases),NA))
m <-  ggplot(bd)+geom_sf(aes(fill=NAME_2))+
geom_point(data=district,aes(x=lon,y=lat,size=Cases),col="red")+
ggrepel::geom_label_repel(data=district,aes(x=lon,y=lat,label=as.character(lab),alpha=.5))+theme_minimal()+theme(legend.position = "")
m
district <- district  %>% mutate(lab=ifelse(Cases>2000,paste(District,Cases),NA))
m <-  ggplot(bd)+geom_sf(aes(fill=NAME_2))+
geom_point(data=district,aes(x=lon,y=lat,size=Cases),col="red")+
ggrepel::geom_label_repel(data=district,aes(x=lon,y=lat,label=as.character(lab),alpha=.5))+theme_minimal()+theme(legend.position = "")
m
data %>% filter(location=="Bangladesh") %>%
group_by(data_type,date) %>%
summarise(sum_case=sum(value))%>%
mutate(cum_case=cumsum(sum_case))%>%
ggplot(aes(date,cum_case))+geom_path(aes(col=data_type),size=1.2)+
labs(y="Cumulative case ",x="months of 2020 ",caption = "Data : WHO")+
scale_y_continuous(breaks = seq(0,1.5e+5,15000))+scale_x_date(breaks = "1 month")
data %>% filter(location=="Bangladesh") %>%
group_by(data_type,date) %>%
summarise(sum_case=sum(value))%>%
mutate(cum_case=cumsum(sum_case))%>%
ggplot(aes(date,cum_case))+geom_path(aes(col=data_type),size=1.2)+
labs(y="Cumulative case ",x="months of 2020 ",caption = "Data : WHO")+
scale_y_continuous(breaks = seq(0,1.5e+6,50000))+scale_x_date(breaks = "one month")
data %>% filter(location=="Bangladesh") %>%
group_by(data_type,date) %>%
summarise(sum_case=sum(value))%>%
mutate(cum_case=cumsum(sum_case))%>%
ggplot(aes(date,cum_case))+geom_path(aes(col=data_type),size=1.2)+
labs(y="Cumulative case ",x="months of 2020 ",caption = "Data : WHO")+
scale_y_continuous(breaks = seq(0,1.5e+6,50000))+scale_x_date(breaks = "one month")
data %>% filter(location=="Bangladesh") %>%
group_by(data_type,date) %>%
summarise(sum_case=sum(value))%>%
mutate(cum_case=cumsum(sum_case))%>%
ggplot(aes(date,cum_case))+geom_path(aes(col=data_type),size=1.2)+
labs(y="Cumulative case ",x="months of 2020 ",caption = "Data : WHO")+
scale_y_continuous(breaks = seq(0,1.5e+6,50000))+
scale_x_date(date_breaks = "one month")
5
data %>% filter(location=="Bangladesh") %>%
group_by(data_type,date) %>%
summarise(sum_case=sum(value))%>%
mutate(cum_case=cumsum(sum_case))%>%
ggplot(aes(date,cum_case))+geom_path(aes(col=data_type),size=1.2)+
labs(y="Cumulative case ",x="months of 2020 ",caption = "Data : WHO")+
scale_y_continuous(breaks = seq(0,1.5e+5,15000))+scale_x_date(breaks = "one month")
data %>% filter(location=="Bangladesh") %>%
group_by(data_type,date) %>%
summarise(sum_case=sum(value))%>%
mutate(cum_case=cumsum(sum_case))
data %>% filter(location=="Bangladesh") %>%
group_by(data_type,date) %>%
summarise(sum_case=sum(value))%>%
mutate(cum_case=cumsum(sum_case))%>%
ggplot(aes(date,cum_case))+geom_path(aes(col=data_type),size=1.2)+
labs(y="Cumulative case ",x="months of 2020 ",caption = "Data : WHO")+
scale_y_continuous(breaks = seq(0,1.5e+5,15000))+scale_x_date(breaks = "one month")
data %>% filter(location=="Bangladesh") %>%
group_by(data_type,date) %>%
summarise(sum_case=sum(value))%>%
mutate(cum_case=cumsum(sum_case))%>%
ggplot(aes(date,cum_case))+geom_path(aes(col=data_type),size=1.2)
data %>% filter(location=="Bangladesh") %>%
group_by(data_type,date) %>%
summarise(sum_case=sum(value))%>%
mutate(cum_case=cumsum(sum_case))%>%
ggplot(aes(date,cum_case))+geom_path(aes(col=data_type),size=1.2)+
labs(y="Cumulative case ",x="months of 2020 ",caption = "Data : WHO")
data %>% filter(location=="Bangladesh") %>%
group_by(data_type,date) %>%
summarise(sum_case=sum(value))%>%
mutate(cum_case=cumsum(sum_case))%>%
ggplot(aes(date,cum_case))+geom_path(aes(col=data_type),size=1.2)+
labs(y="Cumulative case ",x="months of 2020 ",caption = "Data : WHO")+
scale_y_continuous(breaks = seq(0,1.5e+7,50000))+scale_x_date(date_breaks = "1 month")
data %>% filter(location=="Bangladesh") %>%
group_by(data_type,date) %>%
summarise(sum_case=sum(value))%>%
mutate(cum_case=cumsum(sum_case))%>%
ggplot(aes(date,cum_case))+geom_path(aes(col=data_type),size=1.2)+
labs(y="Cumulative case ",x="months of 2020 ",caption = "Data : WHO")+
scale_y_continuous(breaks = seq(0,1.5e+7,50000))+scale_x_date(date_breaks = "1 month",date_labels = "%b %d")
ggplotly(p2)
p2 <- data %>% filter(location=="Bangladesh") %>%
group_by(data_type,date) %>%
summarise(sum_case=sum(value))%>%
mutate(cum_case=cumsum(sum_case))%>%
ggplot(aes(date,cum_case))+geom_path(aes(col=data_type),size=1.2)+
labs(y="Cumulative case ",x="months of 2020 ",caption = "Data : WHO")+
scale_y_continuous(breaks = seq(0,1.5e+7,50000))+scale_x_date(date_breaks = "1 month",date_labels = "%b %d")
ggplotly(p2)
str_replace(data$data_type,"_new","")
data
data <- str_replace(data$data_type,"_new","")
p2 <- data %>% filter(location=="Bangladesh") %>%
group_by(data_type,date) %>%
summarise(sum_case=sum(value))%>%
mutate(cum_case=cumsum(sum_case))%>%
ggplot(aes(date,cum_case))+geom_path(aes(col=data_type),size=1.2)+
labs(y="Cumulative case ",x="months of 2020 ",caption = "Data : WHO")+
scale_y_continuous(breaks = seq(0,1.5e+7,50000))+scale_x_date(date_breaks = "1 month",date_labels = "%b %d")
ggplotly(p2)
data <- str_replace(data$data_type,"_new","")
data$data_type <- str_replace(data$data_type,"_new","")
str_replace(data$data_type,"_new","")
library(stringr)
str_replace(data$data_type,"_new","")
#library(stringr)
load("datafinal.Rdata")
data$data_type <- str_replace(data$data_type,"_new","")
p2 <- data %>% filter(location=="Bangladesh") %>%
group_by(data_type,date) %>%
summarise(sum_case=sum(value))%>%
mutate(cum_case=cumsum(sum_case))%>%
ggplot(aes(date,cum_case))+geom_path(aes(col=data_type),size=1.2)+
labs(y="Cumulative case ",x="months of 2020 ",caption = "Data : WHO")+
scale_y_continuous(breaks = seq(0,1.5e+7,50000))+scale_x_date(date_breaks = "1 month",date_labels = "%b %d")
ggplotly(p2)
df
data %>% filter(location==df$location[1:10]) %>% group_by(location,date) %>%
summarise(sum=sum(value))
data %>% filter(location==df$location[1:10]) %>% group_by(location,date) %>%
summarise(sum=sum(value))%>% mutate(cum=cumsum(sum))
data %>% filter(location==df$location[1:10]) %>% group_by(location,date) %>%
summarise(sum=sum(value))%>% mutate(cum=cumsum(sum)) %>%
ggplot(aes(date,cum))+geom_path(aes(alpha=location))
data %>% filter(location==df$location[1:10]) %>% group_by(location,date) %>%
summarise(sum=sum(value))%>% mutate(cum=cumsum(sum)) %>%
ggplot(aes(date,cum))+geom_path(alpha=.5)
data %>% filter(location==df$location[1:10]) %>% group_by(location,date) %>%
summarise(sum=sum(value))%>% mutate(cum=cumsum(sum)) %>%
ggplot(aes(date,cum))+geom_path(alpha=.5,aes(group=location))
data %>% filter(location==df$location[1:10]) %>% group_by(location,date) %>%
summarise(sum=sum(value))%>% mutate(cum=cumsum(sum)) %>%
ggplot(aes(date,cum))+geom_path(alpha=.5,aes(group=location))+scale_y_log10()
data %>% filter(location==df$location[1:10]) %>% group_by(location,date) %>%
summarise(sum=sum(value))%>% mutate(cum=cumsum(sum)) %>%
ggplot(aes(date,cum))+geom_path(alpha=.5,aes(group=location))+scale_y_sqrt()
data %>% filter(location==df$location[1:10]) %>% group_by(location,date) %>%
summarise(sum=sum(value))%>% mutate(cum=cumsum(sum)) %>% mutate(lab=ifelse(cum==max(cum),location,""))%>%
ggplot(aes(date,cum))+geom_path(alpha=.5,aes(group=location))
data %>% filter(location==df$location[1:10]) %>% group_by(location,date) %>%
summarise(sum=sum(value))%>% mutate(cum=cumsum(sum)) %>% mutate(lab=ifelse(cum==max(cum),location,""))%>%
ggplot(aes(date,cum))+geom_path(alpha=.5,aes(group=location))+
ggrepel::geom_text_repel(aes(label=lab))
data %>% filter(location==df$location[1:10]) %>% group_by(location,date) %>%
summarise(sum=sum(value))%>% mutate(cum=cumsum(sum)) %>% mutate(lab=ifelse(cum==max(cum),location,""))%>%
ggplot(aes(date,cum))+geom_path(alpha=.2,aes(group=location))+
ggrepel::geom_text_repel(aes(label=lab))
data %>% filter(location==df$location[1:10]) %>% group_by(location,date) %>%
summarise(sum=sum(value))%>% mutate(cum=cumsum(sum)) %>% mutate(lab=ifelse(cum==max(cum),location,""))%>%
ggplot(aes(date,cum))+geom_path(alpha=.2,aes(group=location))+scale_y_sqrt()+
ggrepel::geom_text_repel(aes(label=lab))
data %>% filter(location==df$location[1:10]) %>% group_by(location,date) %>%
summarise(sum=sum(value))%>% mutate(cum=cumsum(sum)) %>% mutate(lab=ifelse(cum==max(cum),location,""))%>%
ggplot(aes(date,cum))+geom_path(alpha=.2,size=.5,col="red",aes(group=location))+
ggrepel::geom_text_repel(aes(label=lab))
data %>% filter(location==df$location[1:10]) %>% group_by(location,date) %>%
summarise(sum=sum(value))%>% mutate(cum=cumsum(sum)) %>% mutate(lab=ifelse(cum==max(cum),location,""))%>%
ggplot(aes(date,cum))+geom_path(alpha=.3,size=1.2,col="red",aes(group=location))+
ggrepel::geom_text_repel(aes(label=lab))
data %>% filter(location==df$location[1:10]) %>% group_by(location,date) %>%
summarise(sum=sum(value))%>% mutate(cum=cumsum(sum)) %>% mutate(lab=ifelse(cum==max(cum),location,""))%>%
ggplot(aes(date,cum))+geom_path(alpha=.1,size=1.2,col="red",aes(group=location))+
ggrepel::geom_text_repel(aes(label=lab))
ggplotly(data %>% filter(location==df$location[1:10]) %>% group_by(location,date) %>%
summarise(sum=sum(value))%>% mutate(cum=cumsum(sum)) %>% mutate(lab=ifelse(cum==max(cum),location,""))%>%
ggplot(aes(date,cum))+geom_path(alpha=.1,size=1.2,col="red",aes(group=location))+
ggrepel::geom_text_repel(aes(label=lab)))
data %>% filter(location==df$location[1:10]) %>% group_by(location,date) %>%
summarise(sum=sum(value))%>% mutate(cum=cumsum(sum)) %>% mutate(lab=ifelse(cum==max(cum),location,""))%>%
ggplot(aes(date,cum))+geom_path(alpha=.1,size=1.2,col="red",aes(group=location))+
ggrepel::geom_text_repel(aes(label=lab))
data %>% filter(location==df$location[1:10]) %>% group_by(location,date) %>%
summarise(sum=sum(value))%>% mutate(cum=cumsum(sum)) %>% mutate(lab=ifelse(cum==max(cum),location,""))%>%
ggplot(aes(date,cum))+geom_path(alpha=.1,size=1.2,col="red",aes(group=location))+
ggrepel::geom_text_repel(aes(label=lab))+scale_x_date(date_breaks = "1 month",date_labels = "%b %d")
data %>% filter(location==df$location[1:10]) %>% group_by(location,date) %>%
summarise(sum=sum(value))%>% mutate(cum=cumsum(sum)) %>% mutate(lab=ifelse(cum==max(cum),location,""))%>%
ggplot(aes(date,cum))+geom_path(alpha=.1,size=1.2,col="red",aes(group=location))+
ggrepel::geom_text_repel(aes(label=lab))+scale_x_date(date_breaks = "1 month",date_labels = "%b %d")+theme_minimal()
data %>% filter(location==df$location[1:10]) %>% group_by(location,date) %>%
summarise(sum=sum(value))%>% mutate(cum=cumsum(sum)) %>% mutate(lab=ifelse(cum==max(cum),location,""))%>%
ggplot(aes(date,cum))+geom_path(alpha=.1,size=1.2,col="red",aes(group=location))+
ggrepel::geom_text_repel(aes(label=lab),size=3)+scale_x_date(date_breaks = "1 month",date_labels = "%b %d")+theme_minimal()
data %>% filter(location==df$location[1:10]) %>% group_by(location,date) %>%
summarise(sum=sum(value))%>% mutate(cum=cumsum(sum)) %>% mutate(lab=ifelse(cum==max(cum),location,""))%>%
ggplot(aes(date,cum))+geom_path(alpha=.1,size=1.2,col="red",aes(group=location))+
ggrepel::geom_text_repel(aes(label=lab),size=15)+scale_x_date(date_breaks = "1 month",date_labels = "%b %d")+theme_minimal()
data %>% filter(location==df$location[1:10]) %>% group_by(location,date) %>%
summarise(sum=sum(value))%>% mutate(cum=cumsum(sum)) %>% mutate(lab=ifelse(cum==max(cum),location,""))%>%
ggplot(aes(date,cum))+geom_path(alpha=.1,size=1.2,col="red",aes(group=location))+
ggrepel::geom_text_repel(aes(label=lab),size=10)+scale_x_date(date_breaks = "1 month",date_labels = "%b %d")+theme_minimal()
data %>% filter(location==df$location[1:10]) %>% group_by(location,date) %>%
summarise(sum=sum(value))%>% mutate(cum=cumsum(sum)) %>% mutate(lab=ifelse(cum==max(cum),location,""))%>%
ggplot(aes(date,cum))+geom_path(alpha=.1,size=1.2,col="red",aes(group=location))+
ggrepel::geom_text_repel(aes(label=lab),size=7)+scale_x_date(date_breaks = "1 month",date_labels = "%b %d")+theme_minimal()
